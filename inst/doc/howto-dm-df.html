<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2021-05-11" />

<title>Create a dm object from data frames</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Create a dm object from data frames</h1>
<h4 class="date">2021-05-11</h4>



<div id="building-data-models-from-data-frames-with-dm" class="section level1">
<h1>Building data models from data frames with dm</h1>
<p>dm allows you to create your own relational data models from local data frames. Once your data model is complete, you can deploy it to a range of DBMSs using dm.</p>
<div id="creating-a-dm-object-from-data-frames" class="section level2">
<h2>Creating a dm object from data frames</h2>
<p>The example data set that we will be using is available through the <a href="https://github.com/tidyverse/nycflights13"><code>nycflights13</code></a> package. The five tables that we are working with contain information about all flights that departed from the airports of New York to other destinations in the United States in 2013:</p>
<ul>
<li><code>flights</code> represents the trips taken by planes</li>
<li><code>airlines</code> includes
<ul>
<li>the names of transport organizations (<code>name</code>)</li>
<li>their abbreviated codes (<code>carrier</code>)</li>
</ul></li>
<li><code>airports</code> indicates the ports of departure (<code>origin</code>) and of destination (<code>dest</code>)</li>
<li><code>weather</code> contains meteorological information at each hour</li>
<li><code>planes</code> describes characteristics of the aircraft</li>
</ul>
<p>Once we’ve loaded {nycflights13}, the aforementioned tables are all in our work environment, ready to be accessed.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>airports</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 1,458 x 8</span><span>
#&gt;    faa   name                    lat    lon   alt    tz dst   tzone        
#&gt;    </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>                 </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>        
#&gt; </span><span style="color: #555555;"> 1</span><span> 04G   Lansdowne Airport      41.1  -</span><span style="color: #BB0000;">80.6</span><span>  </span><span style="text-decoration: underline;">1</span><span>044    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 2</span><span> 06A   Moton Field Municipa…  32.5  -</span><span style="color: #BB0000;">85.7</span><span>   264    -</span><span style="color: #BB0000;">6</span><span> A     America/Chic…
#&gt; </span><span style="color: #555555;"> 3</span><span> 06C   Schaumburg Regional    42.0  -</span><span style="color: #BB0000;">88.1</span><span>   801    -</span><span style="color: #BB0000;">6</span><span> A     America/Chic…
#&gt; </span><span style="color: #555555;"> 4</span><span> 06N   Randall Airport        41.4  -</span><span style="color: #BB0000;">74.4</span><span>   523    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 5</span><span> 09J   Jekyll Island Airport  31.1  -</span><span style="color: #BB0000;">81.4</span><span>    11    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 6</span><span> 0A9   Elizabethton Municip…  36.4  -</span><span style="color: #BB0000;">82.2</span><span>  </span><span style="text-decoration: underline;">1</span><span>593    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 7</span><span> 0G6   Williams County Airp…  41.5  -</span><span style="color: #BB0000;">84.5</span><span>   730    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 8</span><span> 0G7   Finger Lakes Regiona…  42.9  -</span><span style="color: #BB0000;">76.8</span><span>   492    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 9</span><span> 0P2   Shoestring Aviation …  39.8  -</span><span style="color: #BB0000;">76.6</span><span>  </span><span style="text-decoration: underline;">1</span><span>000    -</span><span style="color: #BB0000;">5</span><span> U     America/New_…
#&gt; </span><span style="color: #555555;">10</span><span> 0S9   Jefferson County Intl  48.1 -</span><span style="color: #BB0000;">123.</span><span>    108    -</span><span style="color: #BB0000;">8</span><span> A     America/Los_…
#&gt; </span><span style="color: #555555;"># … with 1,448 more rows</span><span>
</span></CODE></PRE>
<p>Your own data will probably not be available as an R package. Whatever format it is in, you will need to be able to load it as data frames into your R session. If the data is too large, consider using dm to connect to the database instead. See <code>vignette(&quot;howto-dm-db&quot;)</code> for details on using dm with databases.</p>
</div>
<div id="adding-tables" class="section level2">
<h2>Adding Tables</h2>
<p>Our first step will be to tell <code>dm</code> which tables we want to work with and how they are connected. For that we can use <code>dm()</code>, passing in the table names as arguments.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dm)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys <span class="ot">&lt;-</span> <span class="fu">dm</span>(airlines, airports, flights, planes, weather)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;">──</span><span> </span><span style="color: #555555;">Metadata</span><span> </span><span style="color: #555555;">───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airlines`, `airports`, `flights`, `planes`, `weather`
#&gt; Columns: 53
#&gt; Primary keys: 0
#&gt; Foreign keys: 0
</span></CODE></PRE>
<p>The <code>as_dm()</code> function is an alternative that works if you already have a list of tables.</p>
</div>
<div id="a-dm-is-a-list" class="section level2">
<h2>A dm is a list</h2>
<p>dm objects behave like lists with a user- and console-friendly print format. In fact, using a dm as a nicer list for organizing your data frames in your environment is an easy first step towards using dm and its data modeling functionality.</p>
<p>Member referencing, by subscript and by name, and list and slice manipulation functions work just as you would expect on a dm object.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(flights_dm_no_keys)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;airlines&quot; &quot;airports&quot; &quot;flights&quot;  &quot;planes&quot;   &quot;weather&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys<span class="sc">$</span>airports</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 1,458 x 8</span><span>
#&gt;    faa   name                    lat    lon   alt    tz dst   tzone        
#&gt;    </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>                 </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>        
#&gt; </span><span style="color: #555555;"> 1</span><span> 04G   Lansdowne Airport      41.1  -</span><span style="color: #BB0000;">80.6</span><span>  </span><span style="text-decoration: underline;">1</span><span>044    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 2</span><span> 06A   Moton Field Municipa…  32.5  -</span><span style="color: #BB0000;">85.7</span><span>   264    -</span><span style="color: #BB0000;">6</span><span> A     America/Chic…
#&gt; </span><span style="color: #555555;"> 3</span><span> 06C   Schaumburg Regional    42.0  -</span><span style="color: #BB0000;">88.1</span><span>   801    -</span><span style="color: #BB0000;">6</span><span> A     America/Chic…
#&gt; </span><span style="color: #555555;"> 4</span><span> 06N   Randall Airport        41.4  -</span><span style="color: #BB0000;">74.4</span><span>   523    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 5</span><span> 09J   Jekyll Island Airport  31.1  -</span><span style="color: #BB0000;">81.4</span><span>    11    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 6</span><span> 0A9   Elizabethton Municip…  36.4  -</span><span style="color: #BB0000;">82.2</span><span>  </span><span style="text-decoration: underline;">1</span><span>593    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 7</span><span> 0G6   Williams County Airp…  41.5  -</span><span style="color: #BB0000;">84.5</span><span>   730    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 8</span><span> 0G7   Finger Lakes Regiona…  42.9  -</span><span style="color: #BB0000;">76.8</span><span>   492    -</span><span style="color: #BB0000;">5</span><span> A     America/New_…
#&gt; </span><span style="color: #555555;"> 9</span><span> 0P2   Shoestring Aviation …  39.8  -</span><span style="color: #BB0000;">76.6</span><span>  </span><span style="text-decoration: underline;">1</span><span>000    -</span><span style="color: #BB0000;">5</span><span> U     America/New_…
#&gt; </span><span style="color: #555555;">10</span><span> 0S9   Jefferson County Intl  48.1 -</span><span style="color: #BB0000;">123.</span><span>    108    -</span><span style="color: #BB0000;">8</span><span> A     America/Los_…
#&gt; </span><span style="color: #555555;"># … with 1,448 more rows</span><span>
</span></CODE></PRE>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys[<span class="fu">c</span>(<span class="st">&quot;airports&quot;</span>, <span class="st">&quot;flights&quot;</span>)]</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;">──</span><span> </span><span style="color: #555555;">Metadata</span><span> </span><span style="color: #555555;">───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airports`, `flights`
#&gt; Columns: 27
#&gt; Primary keys: 0
#&gt; Foreign keys: 0
</span></CODE></PRE>
</div>
<div id="defining-keys" class="section level2">
<h2>Defining Keys</h2>
<p>Even though we now have a <code>dm</code> object that contains all our data, we have not specified how our five tables are connected. To do this we need to define primary keys and foreign keys on the tables.</p>
<p>Primary keys and foreign keys are how relational database tables are linked with each other. A primary key is a column or column tuple that has a unique value for each row within a table. A foreign key is a column or column tuple containing the primary key for a row in another table. Foreign keys act as cross references between tables. They specify the relationships that gives us the <em>relational</em> database. For more information on keys and a crash course on databases, see <code>vignette(&quot;howto-dm-theory&quot;)</code>.</p>
</div>
<div id="primary-keys" class="section level2">
<h2>Primary Keys</h2>
<p><code>dm</code> offers <code>dm_enum_pk_candidates()</code> to identify viable primary keys, and <code>dm_add_pk()</code> to add them.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_enum_pk_candidates</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dm =</span> flights_dm_no_keys,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> planes</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 9 x 3</span><span>
#&gt;   columns     candidate why                                                
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;keys&gt;</span><span>      </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>                                              
#&gt; </span><span style="color: #555555;">1</span><span> tailnum     TRUE      </span><span style="color: #555555;">&quot;&quot;</span><span>                                                 
#&gt; </span><span style="color: #555555;">2</span><span> year        FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: 2001 (284), 2000 (244), 200…
#&gt; </span><span style="color: #555555;">3</span><span> type        FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: Fixed wing multi engine (32…
#&gt; </span><span style="color: #555555;">4</span><span> manufactur… FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: BOEING (1630), AIRBUS INDUS…
#&gt; </span><span style="color: #555555;">5</span><span> model       FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: 737-7H4 (361), A320-232 (25…
#&gt; </span><span style="color: #555555;">6</span><span> engines     FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: 2 (3288), 1 (27), 4 (4), 3 …
#&gt; </span><span style="color: #555555;">7</span><span> seats       FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: 149 (452), 140 (411), 55 (3…
#&gt; </span><span style="color: #555555;">8</span><span> speed       FALSE     </span><span style="color: #555555;">&quot;</span><span>has 3299 missing values, and duplicate values: 43…
#&gt; </span><span style="color: #555555;">9</span><span> engine      FALSE     </span><span style="color: #555555;">&quot;</span><span>has duplicate values: Turbo-fan (2750), Turbo-jet…
</span></CODE></PRE>
<p>Now, we add the primary keys that we have identified:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>flights_dm_only_pks <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  flights_dm_no_keys <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(<span class="at">table =</span> airlines, <span class="at">columns =</span> carrier) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(airports, faa) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(planes, tailnum)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>flights_dm_only_pks</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;">──</span><span> </span><span style="color: #555555;">Metadata</span><span> </span><span style="color: #555555;">───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airlines`, `airports`, `flights`, `planes`, `weather`
#&gt; Columns: 53
#&gt; Primary keys: 3
#&gt; Foreign keys: 0
</span></CODE></PRE>
<p>Note that we demonstrate both named and positional arguments above.</p>
</div>
<div id="foreign-keys" class="section level2">
<h2>Foreign Keys</h2>
<p>To define how our tables are related, we use <code>dm_add_fk()</code> to add foreign keys. In calling <code>dm_add_fk()</code> the <code>table</code> argument is the table that needs a foreign key to link it to a second table. <code>ref_table</code> is the table to be linked to and it needs a primary key already defined for it.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_enum_fk_candidates</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dm =</span> flights_dm_only_pks,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> flights,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref_table =</span> airlines</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 19 x 3</span><span>
#&gt;    columns      candidate why                                              
#&gt;    </span><span style="color: #555555;font-style: italic;">&lt;keys&gt;</span><span>       </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>                                            
#&gt; </span><span style="color: #555555;"> 1</span><span> carrier      TRUE      </span><span style="color: #555555;">&quot;&quot;</span><span>                                               
#&gt; </span><span style="color: #555555;"> 2</span><span> year         FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;"> 3</span><span> month        FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;"> 4</span><span> day          FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;"> 5</span><span> dep_time     FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;"> 6</span><span> sched_dep_t… FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;"> 7</span><span> dep_delay    FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;double&gt; and `value1` &lt;c…
#&gt; </span><span style="color: #555555;"> 8</span><span> arr_time     FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;"> 9</span><span> sched_arr_t… FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;">10</span><span> arr_delay    FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;double&gt; and `value1` &lt;c…
#&gt; </span><span style="color: #555555;">11</span><span> flight       FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;integer&gt; and `value1` &lt;…
#&gt; </span><span style="color: #555555;">12</span><span> tailnum      FALSE     </span><span style="color: #555555;">&quot;</span><span>values of `flights$tailnum` not in `airlines$ca…
#&gt; </span><span style="color: #555555;">13</span><span> origin       FALSE     </span><span style="color: #555555;">&quot;</span><span>values of `flights$origin` not in `airlines$car…
#&gt; </span><span style="color: #555555;">14</span><span> dest         FALSE     </span><span style="color: #555555;">&quot;</span><span>values of `flights$dest` not in `airlines$carri…
#&gt; </span><span style="color: #555555;">15</span><span> air_time     FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;double&gt; and `value1` &lt;c…
#&gt; </span><span style="color: #555555;">16</span><span> distance     FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;double&gt; and `value1` &lt;c…
#&gt; </span><span style="color: #555555;">17</span><span> hour         FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;double&gt; and `value1` &lt;c…
#&gt; </span><span style="color: #555555;">18</span><span> minute       FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;double&gt; and `value1` &lt;c…
#&gt; </span><span style="color: #555555;">19</span><span> time_hour    FALSE     </span><span style="color: #555555;">&quot;</span><span>Can&#39;t combine `value1` &lt;datetime&lt;America/New_Yo…
</span></CODE></PRE>
<p>Having chosen a column from the successful candidates provided by <code>dm_enum_fk_candidates()</code>, we use the <code>dm_add_fk()</code> function to establish the foreign key linking the tables. In the second call to <code>dm_add_fk()</code> we complete the process for the <code>flights</code> and <code>airlines</code> tables that we started above. The <code>carrier</code> column in the <code>airlines</code> table will be added as the foreign key in <code>flights</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>flights_dm_all_keys <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  flights_dm_only_pks <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(<span class="at">table =</span> flights, <span class="at">columns =</span> tailnum, <span class="at">ref_table =</span> planes) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(flights, carrier, airlines) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(flights, origin, airports)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>flights_dm_all_keys</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;">──</span><span> </span><span style="color: #555555;">Metadata</span><span> </span><span style="color: #555555;">───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airlines`, `airports`, `flights`, `planes`, `weather`
#&gt; Columns: 53
#&gt; Primary keys: 3
#&gt; Foreign keys: 3
</span></CODE></PRE>
<p>Having created the required primary and foreign keys to link all the tables together, we now have a relational data model we can work with.</p>
</div>
<div id="visualization" class="section level2">
<h2>Visualization</h2>
<p>Visualizing a data model is a quick and easy way to verify that we have successfully created the model we were aiming for. We can use <code>dm_draw()</code> at any stage of the process to generate a visual representation of the tables and the links between them:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_draw</span>(<span class="at">rankdir =</span> <span class="st">&quot;TB&quot;</span>, <span class="at">view_type =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="419pt" height="449pt" viewBox="0.00 0.00 419.00 449.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 445)">
<title>%0</title>
<g id="a_graph0"><a xlink:title="Data Model">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-445 415,-445 415,4 -4,4"></polygon>
</a>
</g>
<!-- airlines -->
<g id="node1" class="node">
<title>airlines</title>
<polygon fill="#efebdd" stroke="transparent" points="39,-143 39,-163 84,-163 84,-143 39,-143"></polygon>
<text text-anchor="start" x="40.8969" y="-148.4" font-family="Times,serif" font-size="14.00" fill="#000000">airlines</text>
<polygon fill="#ffffff" stroke="transparent" points="39,-123 39,-143 84,-143 84,-123 39,-123"></polygon>
<text text-anchor="start" x="41" y="-128.4" font-family="Times,serif" font-size="14.00" fill="#444444">carrier</text>
<polygon fill="#ffffff" stroke="transparent" points="39,-103 39,-123 84,-123 84,-103 39,-103"></polygon>
<text text-anchor="start" x="41" y="-108.4" font-family="Times,serif" font-size="14.00" fill="#444444">name</text>
<polygon fill="none" stroke="#555555" points="37.5,-102 37.5,-164 84.5,-164 84.5,-102 37.5,-102"></polygon>
</g>
<!-- airports -->
<g id="node2" class="node">
<title>airports</title>
<polygon fill="#efebdd" stroke="transparent" points="361,-178 361,-198 407,-198 407,-178 361,-178"></polygon>
<text text-anchor="start" x="362.6192" y="-183.4" font-family="Times,serif" font-size="14.00" fill="#000000">airports</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-158 361,-178 407,-178 407,-158 361,-158"></polygon>
<text text-anchor="start" x="363" y="-163.4" font-family="Times,serif" font-size="14.00" fill="#444444">faa</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-138 361,-158 407,-158 407,-138 361,-138"></polygon>
<text text-anchor="start" x="363" y="-143.4" font-family="Times,serif" font-size="14.00" fill="#444444">name</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-118 361,-138 407,-138 407,-118 361,-118"></polygon>
<text text-anchor="start" x="363" y="-123.4" font-family="Times,serif" font-size="14.00" fill="#444444">lat</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-98 361,-118 407,-118 407,-98 361,-98"></polygon>
<text text-anchor="start" x="363" y="-103.4" font-family="Times,serif" font-size="14.00" fill="#444444">lon</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-78 361,-98 407,-98 407,-78 361,-78"></polygon>
<text text-anchor="start" x="363" y="-83.4" font-family="Times,serif" font-size="14.00" fill="#444444">alt</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-58 361,-78 407,-78 407,-58 361,-58"></polygon>
<text text-anchor="start" x="363" y="-63.4" font-family="Times,serif" font-size="14.00" fill="#444444">tz</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-38 361,-58 407,-58 407,-38 361,-38"></polygon>
<text text-anchor="start" x="363" y="-43.4" font-family="Times,serif" font-size="14.00" fill="#444444">dst</text>
<polygon fill="#ffffff" stroke="transparent" points="361,-18 361,-38 407,-38 407,-18 361,-18"></polygon>
<text text-anchor="start" x="363" y="-23.4" font-family="Times,serif" font-size="14.00" fill="#444444">tzone</text>
<polygon fill="none" stroke="#555555" points="360,-17 360,-199 408,-199 408,-17 360,-17"></polygon>
</g>
<!-- flights -->
<g id="node3" class="node">
<title>flights</title>
<polygon fill="#efebdd" stroke="transparent" points="120,-381 120,-401 214,-401 214,-381 120,-381"></polygon>
<text text-anchor="start" x="149.1115" y="-386.4" font-family="Times,serif" font-size="14.00" fill="#000000">flights</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-361 120,-381 214,-381 214,-361 120,-361"></polygon>
<text text-anchor="start" x="122" y="-366.4" font-family="Times,serif" font-size="14.00" fill="#444444">year</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-341 120,-361 214,-361 214,-341 120,-341"></polygon>
<text text-anchor="start" x="122" y="-346.4" font-family="Times,serif" font-size="14.00" fill="#444444">month</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-321 120,-341 214,-341 214,-321 120,-321"></polygon>
<text text-anchor="start" x="122" y="-326.4" font-family="Times,serif" font-size="14.00" fill="#444444">day</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-301 120,-321 214,-321 214,-301 120,-301"></polygon>
<text text-anchor="start" x="122" y="-306.4" font-family="Times,serif" font-size="14.00" fill="#444444">dep_time</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-281 120,-301 214,-301 214,-281 120,-281"></polygon>
<text text-anchor="start" x="121.5126" y="-286.4" font-family="Times,serif" font-size="14.00" fill="#444444">sched_dep_time</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-261 120,-281 214,-281 214,-261 120,-261"></polygon>
<text text-anchor="start" x="122" y="-266.4" font-family="Times,serif" font-size="14.00" fill="#444444">dep_delay</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-241 120,-261 214,-261 214,-241 120,-241"></polygon>
<text text-anchor="start" x="122" y="-246.4" font-family="Times,serif" font-size="14.00" fill="#444444">arr_time</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-221 120,-241 214,-241 214,-221 120,-221"></polygon>
<text text-anchor="start" x="122" y="-226.4" font-family="Times,serif" font-size="14.00" fill="#444444">sched_arr_time</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-201 120,-221 214,-221 214,-201 120,-201"></polygon>
<text text-anchor="start" x="122" y="-206.4" font-family="Times,serif" font-size="14.00" fill="#444444">arr_delay</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-181 120,-201 214,-201 214,-181 120,-181"></polygon>
<text text-anchor="start" x="122" y="-186.4" font-family="Times,serif" font-size="14.00" fill="#444444">carrier</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-161 120,-181 214,-181 214,-161 120,-161"></polygon>
<text text-anchor="start" x="122" y="-166.4" font-family="Times,serif" font-size="14.00" fill="#444444">flight</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-141 120,-161 214,-161 214,-141 120,-141"></polygon>
<text text-anchor="start" x="122" y="-146.4" font-family="Times,serif" font-size="14.00" fill="#444444">tailnum</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-121 120,-141 214,-141 214,-121 120,-121"></polygon>
<text text-anchor="start" x="122" y="-126.4" font-family="Times,serif" font-size="14.00" fill="#444444">origin</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-101 120,-121 214,-121 214,-101 120,-101"></polygon>
<text text-anchor="start" x="122" y="-106.4" font-family="Times,serif" font-size="14.00" fill="#444444">dest</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-81 120,-101 214,-101 214,-81 120,-81"></polygon>
<text text-anchor="start" x="122" y="-86.4" font-family="Times,serif" font-size="14.00" fill="#444444">air_time</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-61 120,-81 214,-81 214,-61 120,-61"></polygon>
<text text-anchor="start" x="122" y="-66.4" font-family="Times,serif" font-size="14.00" fill="#444444">distance</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-41 120,-61 214,-61 214,-41 120,-41"></polygon>
<text text-anchor="start" x="122" y="-46.4" font-family="Times,serif" font-size="14.00" fill="#444444">hour</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-21 120,-41 214,-41 214,-21 120,-21"></polygon>
<text text-anchor="start" x="122" y="-26.4" font-family="Times,serif" font-size="14.00" fill="#444444">minute</text>
<polygon fill="#ffffff" stroke="transparent" points="120,-1 120,-21 214,-21 214,-1 120,-1"></polygon>
<text text-anchor="start" x="122" y="-6.4" font-family="Times,serif" font-size="14.00" fill="#444444">time_hour</text>
<polygon fill="none" stroke="#555555" points="119,0 119,-402 215,-402 215,0 119,0"></polygon>
</g>
<!-- planes -->
<g id="node4" class="node">
<title>planes</title>
<polygon fill="#efebdd" stroke="transparent" points="1,-385 1,-405 79,-405 79,-385 1,-385"></polygon>
<text text-anchor="start" x="22.1178" y="-390.4" font-family="Times,serif" font-size="14.00" fill="#000000">planes</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-365 1,-385 79,-385 79,-365 1,-365"></polygon>
<text text-anchor="start" x="3" y="-370.4" font-family="Times,serif" font-size="14.00" fill="#444444">tailnum</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-345 1,-365 79,-365 79,-345 1,-345"></polygon>
<text text-anchor="start" x="3" y="-350.4" font-family="Times,serif" font-size="14.00" fill="#444444">year</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-325 1,-345 79,-345 79,-325 1,-325"></polygon>
<text text-anchor="start" x="3" y="-330.4" font-family="Times,serif" font-size="14.00" fill="#444444">type</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-305 1,-325 79,-325 79,-305 1,-305"></polygon>
<text text-anchor="start" x="2.6893" y="-310.4" font-family="Times,serif" font-size="14.00" fill="#444444">manufacturer</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-285 1,-305 79,-305 79,-285 1,-285"></polygon>
<text text-anchor="start" x="3" y="-290.4" font-family="Times,serif" font-size="14.00" fill="#444444">model</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-265 1,-285 79,-285 79,-265 1,-265"></polygon>
<text text-anchor="start" x="3" y="-270.4" font-family="Times,serif" font-size="14.00" fill="#444444">engines</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-245 1,-265 79,-265 79,-245 1,-245"></polygon>
<text text-anchor="start" x="3" y="-250.4" font-family="Times,serif" font-size="14.00" fill="#444444">seats</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-225 1,-245 79,-245 79,-225 1,-225"></polygon>
<text text-anchor="start" x="3" y="-230.4" font-family="Times,serif" font-size="14.00" fill="#444444">speed</text>
<polygon fill="#ffffff" stroke="transparent" points="1,-205 1,-225 79,-225 79,-205 1,-205"></polygon>
<text text-anchor="start" x="3" y="-210.4" font-family="Times,serif" font-size="14.00" fill="#444444">engine</text>
<polygon fill="none" stroke="#555555" points="0,-204 0,-406 80,-406 80,-204 0,-204"></polygon>
</g>
<!-- weather -->
<g id="node5" class="node">
<title>weather</title>
<polygon fill="#efebdd" stroke="transparent" points="256,-420 256,-440 326,-440 326,-420 256,-420"></polygon>
<text text-anchor="start" x="268.8492" y="-425.4" font-family="Times,serif" font-size="14.00" fill="#000000">weather</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-400 256,-420 326,-420 326,-400 256,-400"></polygon>
<text text-anchor="start" x="258" y="-405.4" font-family="Times,serif" font-size="14.00" fill="#444444">origin</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-380 256,-400 326,-400 326,-380 256,-380"></polygon>
<text text-anchor="start" x="258" y="-385.4" font-family="Times,serif" font-size="14.00" fill="#444444">year</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-360 256,-380 326,-380 326,-360 256,-360"></polygon>
<text text-anchor="start" x="258" y="-365.4" font-family="Times,serif" font-size="14.00" fill="#444444">month</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-340 256,-360 326,-360 326,-340 256,-340"></polygon>
<text text-anchor="start" x="258" y="-345.4" font-family="Times,serif" font-size="14.00" fill="#444444">day</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-320 256,-340 326,-340 326,-320 256,-320"></polygon>
<text text-anchor="start" x="258" y="-325.4" font-family="Times,serif" font-size="14.00" fill="#444444">hour</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-300 256,-320 326,-320 326,-300 256,-300"></polygon>
<text text-anchor="start" x="258" y="-305.4" font-family="Times,serif" font-size="14.00" fill="#444444">temp</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-280 256,-300 326,-300 326,-280 256,-280"></polygon>
<text text-anchor="start" x="258" y="-285.4" font-family="Times,serif" font-size="14.00" fill="#444444">dewp</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-260 256,-280 326,-280 326,-260 256,-260"></polygon>
<text text-anchor="start" x="258" y="-265.4" font-family="Times,serif" font-size="14.00" fill="#444444">humid</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-240 256,-260 326,-260 326,-240 256,-240"></polygon>
<text text-anchor="start" x="258" y="-245.4" font-family="Times,serif" font-size="14.00" fill="#444444">wind_dir</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-220 256,-240 326,-240 326,-220 256,-220"></polygon>
<text text-anchor="start" x="257.5645" y="-225.4" font-family="Times,serif" font-size="14.00" fill="#444444">wind_speed</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-200 256,-220 326,-220 326,-200 256,-200"></polygon>
<text text-anchor="start" x="258" y="-205.4" font-family="Times,serif" font-size="14.00" fill="#444444">wind_gust</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-180 256,-200 326,-200 326,-180 256,-180"></polygon>
<text text-anchor="start" x="258" y="-185.4" font-family="Times,serif" font-size="14.00" fill="#444444">precip</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-160 256,-180 326,-180 326,-160 256,-160"></polygon>
<text text-anchor="start" x="258" y="-165.4" font-family="Times,serif" font-size="14.00" fill="#444444">pressure</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-140 256,-160 326,-160 326,-140 256,-140"></polygon>
<text text-anchor="start" x="258" y="-145.4" font-family="Times,serif" font-size="14.00" fill="#444444">visib</text>
<polygon fill="#ffffff" stroke="transparent" points="256,-120 256,-140 326,-140 326,-120 256,-120"></polygon>
<text text-anchor="start" x="258" y="-125.4" font-family="Times,serif" font-size="14.00" fill="#444444">time_hour</text>
<polygon fill="none" stroke="#555555" points="255,-119 255,-441 327,-441 327,-119 255,-119"></polygon>
</g>
</g>
</svg>

<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(airlines, carrier) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_draw</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="176pt" height="164pt" viewBox="0.00 0.00 176.00 164.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 160)">
<title>%0</title>
<g id="a_graph0"><a xlink:title="Data Model">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-160 172,-160 172,4 -4,4"></polygon>
</a>
</g>
<!-- airlines -->
<g id="node1" class="node">
<title>airlines</title>
<polygon fill="#efebdd" stroke="transparent" points="119,-69 119,-89 164,-89 164,-69 119,-69"></polygon>
<text text-anchor="start" x="120.8969" y="-74.4" font-family="Times,serif" font-size="14.00" fill="#000000">airlines</text>
<polygon fill="#ffffff" stroke="transparent" points="119,-49 119,-69 164,-69 164,-49 119,-49"></polygon>
<text text-anchor="start" x="121" y="-55.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">carrier</text>
<polygon fill="none" stroke="#555555" points="117.5,-48 117.5,-90 164.5,-90 164.5,-48 117.5,-48"></polygon>
</g>
<!-- airports -->
<g id="node2" class="node">
<title>airports</title>
<polygon fill="#efebdd" stroke="transparent" points="118,-122 118,-142 164,-142 164,-122 118,-122"></polygon>
<text text-anchor="start" x="119.6192" y="-127.4" font-family="Times,serif" font-size="14.00" fill="#000000">airports</text>
<polygon fill="none" stroke="#555555" points="117,-121 117,-143 165,-143 165,-121 117,-121"></polygon>
</g>
<!-- flights -->
<g id="node3" class="node">
<title>flights</title>
<polygon fill="#efebdd" stroke="transparent" points="44,-128 44,-148 83,-148 83,-128 44,-128"></polygon>
<text text-anchor="start" x="45.6115" y="-133.4" font-family="Times,serif" font-size="14.00" fill="#000000">flights</text>
<polygon fill="none" stroke="#555555" points="42.5,-127 42.5,-149 83.5,-149 83.5,-127 42.5,-127"></polygon>
</g>
<!-- planes -->
<g id="node4" class="node">
<title>planes</title>
<polygon fill="#efebdd" stroke="transparent" points="44,-68 44,-88 83,-88 83,-68 44,-68"></polygon>
<text text-anchor="start" x="45.6178" y="-73.4" font-family="Times,serif" font-size="14.00" fill="#000000">planes</text>
<polygon fill="none" stroke="#555555" points="42.5,-67 42.5,-89 83.5,-89 83.5,-67 42.5,-67"></polygon>
</g>
<!-- weather -->
<g id="node5" class="node">
<title>weather</title>
<polygon fill="#efebdd" stroke="transparent" points="3,-8 3,-28 51,-28 51,-8 3,-8"></polygon>
<text text-anchor="start" x="4.8492" y="-13.4" font-family="Times,serif" font-size="14.00" fill="#000000">weather</text>
<polygon fill="none" stroke="#555555" points="2,-7 2,-29 52,-29 52,-7 2,-7"></polygon>
</g>
</g>
</svg>

<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>flights_dm_only_pks <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(flights, tailnum, planes) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_draw</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="182pt" height="178pt" viewBox="0.00 0.00 182.00 178.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 174)">
<title>%0</title>
<g id="a_graph0"><a xlink:title="Data Model">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-174 178,-174 178,4 -4,4"></polygon>
</a>
</g>
<!-- airlines -->
<g id="node1" class="node">
<title>airlines</title>
<polygon fill="#efebdd" stroke="transparent" points="5,-149 5,-169 50,-169 50,-149 5,-149"></polygon>
<text text-anchor="start" x="6.8969" y="-154.4" font-family="Times,serif" font-size="14.00" fill="#000000">airlines</text>
<polygon fill="#ffffff" stroke="transparent" points="5,-129 5,-149 50,-149 50,-129 5,-129"></polygon>
<text text-anchor="start" x="7" y="-135.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">carrier</text>
<polygon fill="none" stroke="#555555" points="3.5,-128 3.5,-170 50.5,-170 50.5,-128 3.5,-128"></polygon>
</g>
<!-- airports -->
<g id="node2" class="node">
<title>airports</title>
<polygon fill="#efebdd" stroke="transparent" points="76,-141 76,-161 122,-161 122,-141 76,-141"></polygon>
<text text-anchor="start" x="77.6192" y="-146.4" font-family="Times,serif" font-size="14.00" fill="#000000">airports</text>
<polygon fill="#ffffff" stroke="transparent" points="76,-121 76,-141 122,-141 122,-121 76,-121"></polygon>
<text text-anchor="start" x="78" y="-127.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">faa</text>
<polygon fill="none" stroke="#555555" points="75,-120 75,-162 123,-162 123,-120 75,-120"></polygon>
</g>
<!-- flights -->
<g id="node3" class="node">
<title>flights</title>
<polygon fill="#efebdd" stroke="transparent" points="34,-77 34,-97 80,-97 80,-77 34,-77"></polygon>
<text text-anchor="start" x="39.1115" y="-82.4" font-family="Times,serif" font-size="14.00" fill="#000000">flights</text>
<polygon fill="#ffffff" stroke="transparent" points="34,-57 34,-77 80,-77 80,-57 34,-57"></polygon>
<text text-anchor="start" x="35.6115" y="-62.4" font-family="Times,serif" font-size="14.00" fill="#444444">tailnum</text>
<polygon fill="none" stroke="#555555" points="33,-56 33,-98 81,-98 81,-56 33,-56"></polygon>
</g>
<!-- planes -->
<g id="node4" class="node">
<title>planes</title>
<polygon fill="#efebdd" stroke="transparent" points="124,-77 124,-97 170,-97 170,-77 124,-77"></polygon>
<text text-anchor="start" x="129.1178" y="-82.4" font-family="Times,serif" font-size="14.00" fill="#000000">planes</text>
<polygon fill="#ffffff" stroke="transparent" points="124,-57 124,-77 170,-77 170,-57 124,-57"></polygon>
<text text-anchor="start" x="125.6115" y="-63.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">tailnum</text>
<polygon fill="none" stroke="#555555" points="123,-56 123,-98 171,-98 171,-56 123,-56"></polygon>
</g>
<!-- flights&#45;&gt;planes -->
<g id="edge1" class="edge">
<title>flights:tailnum-&gt;planes:tailnum</title>
<path fill="none" stroke="#555555" d="M80,-67C95.5833,-67 101.8532,-67 113.6529,-67"></path>
<polygon fill="#555555" stroke="#555555" points="114,-70.5001 124,-67 114,-63.5001 114,-70.5001"></polygon>
</g>
<!-- weather -->
<g id="node5" class="node">
<title>weather</title>
<polygon fill="#efebdd" stroke="transparent" points="43,-8 43,-28 91,-28 91,-8 43,-8"></polygon>
<text text-anchor="start" x="44.8492" y="-13.4" font-family="Times,serif" font-size="14.00" fill="#000000">weather</text>
<polygon fill="none" stroke="#555555" points="42,-7 42,-29 92,-29 92,-7 42,-7"></polygon>
</g>
</g>
</svg>

<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>flights_dm_all_keys <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_draw</span>()</span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="152pt" height="200pt" viewBox="0.00 0.00 152.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>%0</title>
<g id="a_graph0"><a xlink:title="Data Model">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-196 148,-196 148,4 -4,4"></polygon>
</a>
</g>
<!-- airlines -->
<g id="node1" class="node">
<title>airlines</title>
<polygon fill="#efebdd" stroke="transparent" points="95,-141 95,-161 140,-161 140,-141 95,-141"></polygon>
<text text-anchor="start" x="96.8969" y="-146.4" font-family="Times,serif" font-size="14.00" fill="#000000">airlines</text>
<polygon fill="#ffffff" stroke="transparent" points="95,-121 95,-141 140,-141 140,-121 95,-121"></polygon>
<text text-anchor="start" x="97" y="-127.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">carrier</text>
<polygon fill="none" stroke="#555555" points="93.5,-120 93.5,-162 140.5,-162 140.5,-120 93.5,-120"></polygon>
</g>
<!-- airports -->
<g id="node2" class="node">
<title>airports</title>
<polygon fill="#efebdd" stroke="transparent" points="94,-21 94,-41 140,-41 140,-21 94,-21"></polygon>
<text text-anchor="start" x="95.6192" y="-26.4" font-family="Times,serif" font-size="14.00" fill="#000000">airports</text>
<polygon fill="#ffffff" stroke="transparent" points="94,-1 94,-21 140,-21 140,-1 94,-1"></polygon>
<text text-anchor="start" x="96" y="-7.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">faa</text>
<polygon fill="none" stroke="#555555" points="93,0 93,-42 141,-42 141,0 93,0"></polygon>
</g>
<!-- flights -->
<g id="node3" class="node">
<title>flights</title>
<polygon fill="#efebdd" stroke="transparent" points="4,-101 4,-121 50,-121 50,-101 4,-101"></polygon>
<text text-anchor="start" x="9.1115" y="-106.4" font-family="Times,serif" font-size="14.00" fill="#000000">flights</text>
<polygon fill="#ffffff" stroke="transparent" points="4,-81 4,-101 50,-101 50,-81 4,-81"></polygon>
<text text-anchor="start" x="6" y="-86.4" font-family="Times,serif" font-size="14.00" fill="#444444">carrier</text>
<polygon fill="#ffffff" stroke="transparent" points="4,-61 4,-81 50,-81 50,-61 4,-61"></polygon>
<text text-anchor="start" x="5.6115" y="-66.4" font-family="Times,serif" font-size="14.00" fill="#444444">tailnum</text>
<polygon fill="#ffffff" stroke="transparent" points="4,-41 4,-61 50,-61 50,-41 4,-41"></polygon>
<text text-anchor="start" x="6" y="-46.4" font-family="Times,serif" font-size="14.00" fill="#444444">origin</text>
<polygon fill="none" stroke="#555555" points="3,-40 3,-122 51,-122 51,-40 3,-40"></polygon>
</g>
<!-- flights&#45;&gt;airlines -->
<g id="edge1" class="edge">
<title>flights:carrier-&gt;airlines:carrier</title>
<path fill="none" stroke="#555555" d="M50,-91C72.787,-91 69.9925,-120.0063 85.1849,-128.6176"></path>
<polygon fill="#555555" stroke="#555555" points="84.4566,-132.0424 95,-131 86.1078,-125.2399 84.4566,-132.0424"></polygon>
</g>
<!-- flights&#45;&gt;airports -->
<g id="edge2" class="edge">
<title>flights:origin-&gt;airports:faa</title>
<path fill="none" stroke="#555555" d="M50,-51C72.2991,-51 69.4778,-22.5234 83.9268,-13.6245"></path>
<polygon fill="#555555" stroke="#555555" points="85.2055,-16.9083 94,-11 83.4406,-10.1344 85.2055,-16.9083"></polygon>
</g>
<!-- planes -->
<g id="node4" class="node">
<title>planes</title>
<polygon fill="#efebdd" stroke="transparent" points="94,-81 94,-101 140,-101 140,-81 94,-81"></polygon>
<text text-anchor="start" x="99.1178" y="-86.4" font-family="Times,serif" font-size="14.00" fill="#000000">planes</text>
<polygon fill="#ffffff" stroke="transparent" points="94,-61 94,-81 140,-81 140,-61 94,-61"></polygon>
<text text-anchor="start" x="95.6115" y="-67.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">tailnum</text>
<polygon fill="none" stroke="#555555" points="93,-60 93,-102 141,-102 141,-60 93,-60"></polygon>
</g>
<!-- flights&#45;&gt;planes -->
<g id="edge3" class="edge">
<title>flights:tailnum-&gt;planes:tailnum</title>
<path fill="none" stroke="#555555" d="M50,-71C65.5833,-71 71.8532,-71 83.6529,-71"></path>
<polygon fill="#555555" stroke="#555555" points="84,-74.5001 94,-71 84,-67.5001 84,-74.5001"></polygon>
</g>
<!-- weather -->
<g id="node5" class="node">
<title>weather</title>
<polygon fill="#efebdd" stroke="transparent" points="15,-164 15,-184 63,-184 63,-164 15,-164"></polygon>
<text text-anchor="start" x="16.8492" y="-169.4" font-family="Times,serif" font-size="14.00" fill="#000000">weather</text>
<polygon fill="none" stroke="#555555" points="14,-163 14,-185 64,-185 64,-163 14,-163"></polygon>
</g>
</g>
</svg>

</div>
<div id="integrity-checks" class="section level2">
<h2>Integrity Checks</h2>
<p>As well as checking our data model visually, dm can examine the constraints we have created by the addition of keys and verify that they are sensible.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>flights_dm_no_keys <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_examine_constraints</span>()</span></code></pre></div>
<PRE class="fansi fansi-message"><CODE>#&gt; <span style="color: #00BBBB;">ℹ</span><span> No constraints defined.
</span></CODE></PRE>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>flights_dm_only_pks <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_examine_constraints</span>()</span></code></pre></div>
<PRE class="fansi fansi-message"><CODE>#&gt; <span style="color: #00BBBB;">ℹ</span><span> All constraints satisfied.
</span></CODE></PRE>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>flights_dm_all_keys <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_examine_constraints</span>()</span></code></pre></div>
<PRE class="fansi fansi-message"><CODE>#&gt; <span style="color: #BBBB00;">!</span><span> Unsatisfied constraints:
</span></CODE></PRE>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #BB0000;">●</span><span> Table `flights`: foreign key tailnum into table `planes`: values of `flights$tailnum` not in `planes$tailnum`: N725MQ (575), N722MQ (513), N723MQ (507), N713MQ (483), N735MQ (396), …
</span></CODE></PRE>
<p>The results are presented in a human-readable form, and available as a tibble for programmatic inspection.</p>
</div>
<div id="programming" class="section level2">
<h2>Programming</h2>
<p>Helper functions are available to access details on keys and check results.</p>
<p><code>dm_get_all_pks()</code> returns a data frame with our primary keys:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>flights_dm_only_pks <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_get_all_pks</span>()</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 3 x 2</span><span>
#&gt;   table    pk_col 
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;keys&gt;</span><span> 
#&gt; </span><span style="color: #555555;">1</span><span> airlines carrier
#&gt; </span><span style="color: #555555;">2</span><span> airports faa    
#&gt; </span><span style="color: #555555;">3</span><span> planes   tailnum
</span></CODE></PRE>
<p>A data frame of foreign keys is retrieved with <code>dm_get_all_fks()</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>flights_dm_all_keys <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_get_all_pks</span>()</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 3 x 2</span><span>
#&gt;   table    pk_col 
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>    </span><span style="color: #555555;font-style: italic;">&lt;keys&gt;</span><span> 
#&gt; </span><span style="color: #555555;">1</span><span> airlines carrier
#&gt; </span><span style="color: #555555;">2</span><span> airports faa    
#&gt; </span><span style="color: #555555;">3</span><span> planes   tailnum
</span></CODE></PRE>
<p>We can use <code>tibble::as_tibble()</code> on the result of <code>dm_examine_constraints()</code> to programmatically inspect which constraints are not satisfied:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>flights_dm_all_keys <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_examine_constraints</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; <span style="color: #555555;"># A tibble: 6 x 6</span><span>
#&gt;   table   kind  columns ref_table is_key problem                           
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;keys&gt;</span><span>  </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>  </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>                             
#&gt; </span><span style="color: #555555;">1</span><span> flights FK    tailnum planes    FALSE  </span><span style="color: #555555;">&quot;</span><span>values of `flights$tailnum` not …
#&gt; </span><span style="color: #555555;">2</span><span> airlin… PK    carrier </span><span style="color: #BB0000;">NA</span><span>        TRUE   </span><span style="color: #555555;">&quot;&quot;</span><span>                                
#&gt; </span><span style="color: #555555;">3</span><span> airpor… PK    faa     </span><span style="color: #BB0000;">NA</span><span>        TRUE   </span><span style="color: #555555;">&quot;&quot;</span><span>                                
#&gt; </span><span style="color: #555555;">4</span><span> planes  PK    tailnum </span><span style="color: #BB0000;">NA</span><span>        TRUE   </span><span style="color: #555555;">&quot;&quot;</span><span>                                
#&gt; </span><span style="color: #555555;">5</span><span> flights FK    carrier airlines  TRUE   </span><span style="color: #555555;">&quot;&quot;</span><span>                                
#&gt; </span><span style="color: #555555;">6</span><span> flights FK    origin  airports  TRUE   </span><span style="color: #555555;">&quot;&quot;</span><span>
</span></CODE></PRE>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
